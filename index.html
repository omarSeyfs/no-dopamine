<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>No Dopamine Tracker</title>

<style>
  body {
    background: #111;
    color: white;
    font-family: system-ui, sans-serif;
    padding: 20px;
  }

  h1 {
    margin-bottom: 20px;
  }

  .container {
    display: flex;
    gap: 60px;
  }

  .person {
    flex: 1;
  }

  .name {
    font-size: 20px;
    margin-bottom: 10px;
  }

  .grid {
    display: grid;
    grid-template-columns: repeat(53, 12px);
    gap: 4px;
  }

  .day {
    width: 12px;
    height: 12px;
    background: #222;
    border-radius: 3px;
    cursor: pointer;
  }

  .day.done {
    background: #2ecc71;
  }

  .day:hover {
    outline: 1px solid #888;
  }
</style>
</head>

<body>

<h1>NO DOPAMINE</h1>

<div class="container">
  <div class="person">
    <div class="name">Omar</div>
    <div id="omar" class="grid"></div>
  </div>

  <div class="person">
    <div class="name">Samarth</div>
    <div id="samarth" class="grid"></div>
  </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyD5hYcYpCJmcnlKs_R7EJ_DmD2HoLfM1xI",
    authDomain: "habittrackeros.firebaseapp.com",
    projectId: "habittrackeros",
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const start = new Date(2026, 1, 7); // Feb 7 2026
  const end   = new Date(2027, 1, 7); // Feb 7 2027

  function buildGrid(name, containerId) {
    const container = document.getElementById(containerId);

    for (let d = new Date(start); d <= end; d.setDate(d.getDate() + 1)) {
      const dateStr = d.toISOString().slice(0,10);

      const box = document.createElement("div");
      box.className = "day";
      box.title = dateStr;

      const ref = db.collection("habits").doc(name + "_" + dateStr);

      ref.onSnapshot(doc => {
        if (doc.exists && doc.data().done) {
          box.classList.add("done");
        } else {
          box.classList.remove("done");
        }
      });

      box.onclick = async () => {
        const snap = await ref.get();
        const current = snap.exists ? snap.data().done : false;
        ref.set({ done: !current });
      };

      container.appendChild(box);
    }
  }

  buildGrid("omar", "omar");
  buildGrid("samarth", "samarth");
</script>

</body>
</html>
